<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>投保</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<!--标准mui.css-->
		<link rel="stylesheet" href="../css/mui.min.css">
		<!--App自定义的css-->
		<style type="text/css">
			.mui-checkbox.mui-left input[type=checkbox] {
				top: 50%;
				transform: translateY(-50%);
			}
			
			.pay_money {
				width: 90%;
				line-height: 48px;
				height: 48px;
				margin-left: 5%;
				padding: 0;
				border: 1px solid #ffb84e;
				color: #ffb84e;
				border-radius: 50px;
			}
			
			nav.mui-bar {
				box-shadow: none;
				background: transparent;
			}
			
			.mui-table-view .mui-media-object {
				line-height: 80px;
				max-width: 80px;
				height: 80px;
			}
			
			.mui-popover .mui-table-view .mui-table-view-cell:last-child,
			.mui-popover .mui-table-view .mui-table-view-cell:first-child,
			.mui-popover.mui-popover-action .mui-table-view {
				border-radius: 0px;
			}
			
			.mui-content>.mui-table-view:first-child {
				margin-top: 0;
			}
		</style>
	</head>

	<body>

		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">投保</h1>
		</header>

		<nav class="mui-bar mui-bar-tab">
			<button class="pay_money" id="pay_money">立即支付</button>
		</nav>

		<div class="mui-content">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell mui-media">
					<img class="mui-media-object mui-pull-left" src="../images/shuijiao.jpg">
					<div class="mui-media-body">
						成长无忧少儿综合意外险
						<p class="mui-ellipsis">承包公司<span class="">众安保险</span></p>
						<p class="mui-ellipsis">保障期限<span class="">1年</span></p>
					</div>
				</li>
				<li class="mui-table-view-cell mui-media">
					<p class="">
						生效日期
						<span class="mui-pull-right">
							2018-01-08
						</span>
					</p>
				</li>
				<li class="mui-table-view-cell mui-media">

					<p class="mui-navigate-right">

						<span class="previousElementSibling">选择被保人</span>
						<button type="button" class="mui-pull-right mui-btn showUserPicker" id="showUserPicker1" href="tableviews-with-swipe.html">111
						</button>
					</p>
				</li>
				<li class="mui-table-view-cell mui-media">

					<p class="mui-navigate-right">
						<span class="previousElementSibling">选择额度</span>
						<button type="button" class="mui-pull-right mui-btn showUserPicker" id="showUserPicker2">111
						</button>
					</p>
				</li>
				<li class="mui-table-view-cell mui-media">
					<p class="">
						<span class="previousElementSibling">选择额度</span>
						<span class="mui-pull-right">
							1年
						</span>
					</p>
				</li>
				<li class="mui-table-view-cell mui-media">
					<p class="">
						保险价格
						<span class="mui-pull-right">
							￥33.00
						</span>
					</p>
				</li>

			</ul>
			<p class="mui-input-row mui-checkbox mui-left">
				<label>我已经认真阅读<a href="javascript:;">《保险条款》</a><a href="javascript:;">《投保须知》</a>了解并接受，包括有关责任条款
				及免除责任条款，承保限制等约定
				</label>
				<input name="checkbox" value="Item 2" type="checkbox" checked="" id="agree">
			</p>
		</div>
		<div id="picture" class="mui-popover mui-popover-action mui-popover-bottom" style="display: none;">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="#">拍照或录像</a>
				</li>
				<li class="mui-table-view-cell">
					<a href="#">选取现有的</a>
				</li>
			</ul>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="#picture" class=""><b>取消</b></a>
				</li>
			</ul>
		</div>

		<div id="InsurersList" class="mui-popover mui-popover-action mui-popover-bottom" style="display: none;">
			<ul id="OA_task_1" class="mui-table-view">
				<li class="mui-table-view-cell">
					<div class="mui-slider-right mui-disabled">
						<a class="mui-btn mui-btn-red">删除</a>
					</div>
					<div class="mui-slider-handle">
						左滑显示删除按钮
					</div>
				</li>
				<li class="mui-table-view-cell">
					<div class="mui-slider-left mui-disabled">
						<a class="mui-btn mui-btn-red">删除</a>
					</div>
					<div class="mui-slider-handle">
						右滑显示删除按钮
					</div>
				</li>
				<li class="mui-table-view-cell">
					<div class="mui-slider-left mui-disabled">
						<a class="mui-btn mui-btn-red">删除</a>
					</div>
					<div class="mui-slider-right mui-disabled">
						<a class="mui-btn mui-btn-red">删除</a>
					</div>
					<div class="mui-slider-handle">
						左右滑动均可显示删除按钮
					</div>
				</li>
			</ul>

	</body>
	<script src="../js/mui.min.js"></script>
	<script>
		mui.init({
			swipeBack: true //启用右滑关闭功能
		});
		mui.plusReady(function() {
			//判断在plus5+环境下还是浏览器环境下，取值方式不同
			if(mui.os.ios || (mui.os.android)) {
				var self = plus.webview.currentWebview();
				var name = self.name;
				alert(name) //...
				alert(localStorage.getItem('a'))
			} else {
				console.log(localStorage.getItem('a'))
			}

			mui('body').on('tap', '.mui-popover-action li>a', function() {
				var a = this,
					parent;
				//根据点击按钮，反推当前是哪个actionsheet
				for(parent = a.parentNode; parent != document.body; parent = parent.parentNode) {
					if(parent.classList.contains('mui-popover-action')) {
						break;
					}
				}
				//关闭actionsheet
				mui('#' + parent.id).popover('toggle');
			})

			mui('.mui-bar').on('tap', '#pay_money', function() {
				var check = true; //设置全局变量判断必选条件是否全部填写和选中
				var agreeId = document.getElementById('agree').checked
				//判断输入框的选项是否已经填写值
				mui(".mui-navigate-right button").each(function() {
					//若当前input为空，则alert提醒
					if(!this.innerText || this.innerText == "") {
						var label = this.previousElementSibling;
						mui.alert(label.innerText + "不允许为空");
						check = false;
						return false;
					}
				});
				//判断相关条款是否已经同意
				if(agreeId == false) {
					mui.alert('请同意相关条款');
					check = false;
					return false
				}

				if(check) {
					mui('#picture').popover('show');
					check = null;
				}

			})

			mui('.mui-navigate-right').on('tap', '#showUserPicker1', function() {
				var href = this.getAttribute('href');

				//非plus环境，直接走href跳转
				if(!mui.os.plus) {
					location.href = href;
					return;
				}

				var id = this.getAttribute("data-wid");
				if(!id) {
					id = href;
					console.log('此时的ID是' + id)
				}

				if(href && ~href.indexOf('.html')) {
					//打开窗口的相关参数
					var options = {
						styles: {
							popGesture: "close"
						},
						extras: {}
					};
					//如下场景不适用下拉回弹：
					//1、单webview下拉刷新；2、底部有fixed定位的div的页面
					if(!~id.indexOf('pullrefresh.html') && !~href.indexOf("examples/tabbar.html") && !~href.indexOf("list-to-detail/listview.html")) {
						options.styles.bounce = "vertical";
					}
					//图标页面需要启动硬件加速
					if(~id.indexOf('icons.html') || ~id.indexOf("echarts.html")) {
						options.styles.hardwareAccelerated = true;
					}
					if(~id.indexOf('im-chat.html')) {
						options.extras.acceleration = "none";
					}

					var titleType = this.getAttribute("data-title-type");
					if(titleType && titleType.indexOf("native") > -1) { //原生导航
						options.styles.titleNView = {
							autoBackButton: true,
							backgroundColor: '#f7f7f7',
							titleText: this.innerHTML.trim(),
							splitLine: {
								color: '#cccccc'
							}
						};

						options.show = {
							event: 'loaded'
						}
						//有原生标题的情况下，就不需要waiting框了
						options.waiting = {
							autoShow: false
						}

						//透明渐变导航,增加类型设置
						if(titleType == "transparent_native") {
							options.styles.titleNView.type = "transparent";
						}

						//处理原生图片轮播
						if(~id.indexOf("slider-native.html")) {
							options.styles.subNViews = [{ //配置图片轮播
								id: 'slider-native',
								type: 'ImageSlider',
								styles: {
									left: 0,
									right: 0,
									top: 0,
									height: '200px',
									position: 'static',
									loop: true,
									images: [{
										src: '_www/images/yuantiao.jpg',
										width: '100%'
									}, {
										src: '_www/images/shuijiao.jpg',
										width: '100%',
									}, {
										src: '_www/images/muwu.jpg',
										width: '100%',
									}, {
										src: '_www/images/cbd.jpg',
										width: '100%',
									}]
								}
							}];
						}
					} else {
						//非原生导航，需要设置顶部状态栏占位
						options.styles.statusbar = {
							background: "#f7f7f7"
						}
					}

					//侧滑菜单需动态控制一下zindex值；
					if(~id.indexOf('offcanvas-')) {
						options.styles.zindex = 9998;
						options.styles.popGesture = ~id.indexOf('offcanvas-with-right') ? "close" : "none";
					}

					if(id && id == "viewgroup") { //强制启用截屏
						options.extras.acceleration = "capture";
					}
					//打开新窗口
					mui.openWindow(href, id, options);

				}
			})

			//返回回来要执行的方法   
			function fun1(e) {
				var val = e.detail.inputVal
				document.getElementById('showUserPicker1').innerText = val
			}
			//自定义窗体事件  doit 要和b页面定义的 事件名称一致   
			window.addEventListener('doit', fun1);

			//mui('#InsurersList').popover('show');
		})
	</script>

</html>